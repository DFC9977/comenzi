<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin â€” Gosbi</title>
  <style>
    :root {
      --bg: #0b0f14;
      --card: #121924;
      --line: #1e2d3d;
      --text: #e8eef6;
      --muted: #9fb0c3;
      --primary: #4da3ff;
      --ok: #35d07f;
      --danger: #ff5d5d;
      --warn: #f5a623;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { min-height: 100%; }
    body {
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: radial-gradient(800px 400px at 20% 0%, rgba(77,163,255,.10), transparent 60%),
                  radial-gradient(700px 400px at 80% 20%, rgba(53,208,127,.07), transparent 60%),
                  var(--bg);
      color: var(--text);
      font-size: 15px;
      line-height: 1.5;
    }

    /* ---- TOPBAR ---- */
    .topbar {
      position: sticky; top: 0; z-index: 100;
      display: flex; align-items: center; justify-content: space-between;
      padding: 12px 16px;
      background: rgba(11,15,20,.92);
      border-bottom: 1px solid var(--line);
      backdrop-filter: blur(10px);
      gap: 10px;
    }
    .topbar-brand { font-weight: 900; font-size: 18px; }
    .topbar-brand span { color: var(--primary); }
    .topbar-right { display: flex; align-items: center; gap: 8px; }
    .topbar-right button {
      padding: 8px 14px; border-radius: 10px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.06); color: #fff;
      font-weight: 700; font-size: 14px; cursor: pointer;
    }

    /* ---- TABS ---- */
    .tabs-wrap {
      overflow-x: auto; -webkit-overflow-scrolling: touch;
      border-bottom: 1px solid var(--line);
      background: rgba(11,15,20,.6);
      backdrop-filter: blur(8px);
      position: sticky; top: 57px; z-index: 90;
    }
    .tabs {
      display: flex; gap: 0;
      padding: 0 16px;
      min-width: max-content;
    }
    .tab {
      padding: 14px 18px;
      font-weight: 700; font-size: 14px;
      color: var(--muted);
      border-bottom: 2px solid transparent;
      cursor: pointer;
      white-space: nowrap;
      transition: color .15s, border-color .15s;
      background: none; border-top: none; border-left: none; border-right: none;
    }
    .tab.active { color: var(--primary); border-bottom-color: var(--primary); }

    /* ---- CONTAINER ---- */
    .container {
      max-width: 700px;
      margin: 0 auto;
      padding: 16px 14px 60px;
    }

    /* ---- TAB PANELS ---- */
    .tab-panel { display: none; }
    .tab-panel.active { display: block; }

    /* ---- AUTH CARD ---- */
    .auth-card {
      background: rgba(18,25,36,.95);
      border: 1px solid var(--line);
      border-radius: 18px;
      padding: 20px;
      margin-bottom: 20px;
    }
    .auth-card input {
      width: 100%; padding: 14px; border-radius: 12px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.06); color: #fff;
      font-size: 16px; margin-bottom: 10px;
    }
    .auth-card input:focus { outline: none; border-color: var(--primary); }
    .auth-btns { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 4px; }
    .btn-primary {
      padding: 14px; border-radius: 12px; border: none;
      background: var(--primary); color: #07111d;
      font-weight: 900; font-size: 16px; cursor: pointer;
    }
    .btn-ghost {
      padding: 14px; border-radius: 12px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.06); color: #fff;
      font-weight: 700; font-size: 15px; cursor: pointer;
    }
    #me { font-size: 13px; opacity: .6; margin-top: 10px; }
    #err { font-size: 14px; margin-top: 8px; min-height: 18px; }

    /* ---- SECTION TITLES ---- */
    .section-title {
      font-size: 11px; font-weight: 800; opacity: .45;
      text-transform: uppercase; letter-spacing: .8px;
      margin: 20px 0 10px;
    }

    /* ---- ADMIN SECTIONS hidden until logged in ---- */
    .admin-section { display: none; }
  </style>
</head>
<body>

<!-- TOPBAR -->
<div class="topbar">
  <div class="topbar-brand">Gosbi <span>Admin</span></div>
  <div class="topbar-right" id="me"></div>
</div>

<!-- TABS -->
<div class="tabs-wrap admin-section">
  <div class="tabs">
    <button class="tab active" data-panel="panelClients">ğŸ‘¥ ClienÈ›i</button>
    <button class="tab" data-panel="panelPromotions">ğŸ“£ PromoÈ›ii</button>
    <button class="tab" data-panel="panelNotifications">ğŸ“± NotificÄƒri</button>
    <button class="tab" data-panel="panelCounties">ğŸ—º JudeÈ›e</button>
    <button class="tab" data-panel="panelPasswordResets">ğŸ”‘ Resetare parole</button>
  </div>
</div>

<div class="container">

  <!-- AUTH -->
  <div class="auth-card" id="authCard">
    <div style="font-weight:900; font-size:16px; margin-bottom:12px;">Autentificare Admin</div>
    <input id="phone" type="tel" placeholder="Telefon (ex: 0744...)" autocomplete="username" />
    <input id="pass" type="password" placeholder="ParolÄƒ" autocomplete="current-password" />
    <div class="auth-btns">
      <button class="btn-primary" id="btnLogin">IntrÄƒ</button>
      <button class="btn-ghost" id="btnLogout">IeÈ™i</button>
    </div>
    <div id="err"></div>
  </div>

  <!-- Tab panels â€” wrapped in single admin-section so display:block from JS
       doesn't override tab-panel CSS visibility on individual panels -->
  <div class="admin-section" id="tabPanels">

    <!-- ===== TAB: CLIENÈšI ===== -->
    <div class="tab-panel active" id="panelClients">
      <div class="section-title">â³ ClienÈ›i Ã®n aÈ™teptare</div>
      <div id="pending"></div>
      <div class="section-title" style="margin-top:28px;">âœ… ClienÈ›i activi</div>
      <div id="active"></div>
    </div>

    <!-- ===== TAB: PROMOÈšII ===== -->
    <div class="tab-panel" id="panelPromotions">
      <div class="section-title">ğŸ“£ Gestionare promoÈ›ii</div>
      <div style="font-size:13px; opacity:.6; margin-bottom:14px;">
        PromoÈ›iile publicate apar la clienÈ›i Ã®ntr-un tab dedicat, cu notificare pentru promoÈ›ii necitite.
      </div>
      <div id="promotionsContainer"></div>
    </div>

    <!-- ===== TAB: NOTIFICÄ‚RI WhatsApp ===== -->
    <div class="tab-panel" id="panelNotifications">
      <div class="section-title">ğŸ“± NotificÄƒri livrare per judeÈ›</div>
      <div style="font-size:13px; opacity:.6; margin-bottom:14px;">
        SelecteazÄƒ judeÈ›ul, editeazÄƒ mesajul È™i trimite WhatsApp fiecÄƒrui client activ din acel judeÈ›.
      </div>
      <div id="notificationsContainer"></div>
    </div>

    <!-- ===== TAB: JUDEÈšE ===== -->
    <div class="tab-panel" id="panelCounties">
      <div class="section-title">ğŸ—º Configurare judeÈ›e & zile livrare</div>
      <div style="font-size:13px; opacity:.6; margin-bottom:14px;">
        SeteazÄƒ ziua fixÄƒ de livrare per judeÈ›. Aceasta se aplicÄƒ automat clienÈ›ilor din acel judeÈ›.
      </div>
      <div id="countiesContainer"></div>
    </div>

    <!-- ===== TAB: RESETARE PAROLE ===== -->
    <div class="tab-panel" id="panelPasswordResets">
      <div class="section-title">ğŸ”‘ Cereri resetare parolÄƒ</div>
      <div style="font-size:13px; opacity:.6; margin-bottom:14px;">
        ClienÈ›ii care au uitat parola apar mai jos. ReseteazÄƒ parola lor Ã®n
        <a href="https://console.firebase.google.com/project/gosbiromania/authentication/users"
           target="_blank" rel="noopener"
           style="color:#4da3ff;">Firebase Console â†’ Authentication</a>
        (cautÄƒ dupÄƒ <code style="font-size:12px;opacity:.8;">telefon@phone.local</code>),
        apoi marcheazÄƒ cererea ca rezolvatÄƒ.
      </div>
      <div id="passwordResetsContainer">
        <div style="opacity:.5;font-size:13px;">Se Ã®ncarcÄƒâ€¦</div>
      </div>
    </div>

  </div><!-- /admin-section tabPanels -->

</div>

<!-- TABS JS -->
<script>
  const tabs = document.querySelectorAll(".tab");
  const panels = document.querySelectorAll(".tab-panel");

  function activateTabById(panelId) {
    tabs.forEach(t => t.classList.remove("active"));
    panels.forEach(p => p.classList.remove("active"));
    const panel = document.getElementById(panelId);
    if (panel) panel.classList.add("active");
    const tab = document.querySelector(`.tab[data-panel="${panelId}"]`);
    if (tab) tab.classList.add("active");
  }

  tabs.forEach(tab => {
    tab.addEventListener("click", () => activateTabById(tab.dataset.panel));
  });

  // DetecÈ›ie hash din URL: admin.html#promotions / #counties / #clients
  const hashMap = {
    clients:     "panelClients",
    promotions:  "panelPromotions",
    counties:    "panelCounties",
    notifications: "panelNotifications",
  };
  const hash = location.hash.replace("#", "");
  if (hashMap[hash]) {
    // AÈ™teptÄƒm ca admin-section-urile sÄƒ fie vizibile (dupÄƒ auth)
    const observer = new MutationObserver(() => {
      const panel = document.getElementById(hashMap[hash]);
      if (panel && panel.closest(".container")) {
        activateTabById(hashMap[hash]);
        observer.disconnect();
      }
    });
    observer.observe(document.body, { attributes: true, subtree: true, attributeFilter: ["style"] });
    // Fallback dupÄƒ 1s
    setTimeout(() => activateTabById(hashMap[hash]), 1000);
  }
</script>

<script type="module" src="./admin.js"></script>
</body>
</html>